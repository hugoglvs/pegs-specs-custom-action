name: Test Action

on: [push, workflow_dispatch]

jobs:
  test-generation:
    runs-on: ubuntu-latest
    name: Test PDF Generation
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create Dummy Assets
        run: |
          mkdir -p assets
          printf "@startuml\nUser->System:Test\n@enduml" > assets/diagram.puml
          # Create a tiny red dot SVG
          echo '<svg width="10" height="10"><circle cx="5" cy="5" r="4" fill="red"/></svg>' > assets/image.svg

      - name: Run PEGS Specs Action
        uses: ./
        with:
          requirements-path: "requirements.csv"
          output-dir: "docs/build"
          project-name: "PEGS Demo Project"
          authors: "Hugo, LÃ©a"
          logo-path: "assets/image.svg"

      - name: Verify Artifacts
        run: |
          ls -R docs/build
          if [ ! -f docs/build/full-specs.pdf ]; then
            echo "full-specs.pdf not generated!"
            exit 1
          fi

      - name: Upload Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: generated-specs-pdf
          path: docs/build/full-specs.pdf
